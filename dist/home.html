<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- ä¿æŒç§»åŠ¨ç«¯ä¼˜åŒ–é…ç½® -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å˜Ÿå˜Ÿä¹å›­ - å¿«ä¹ä¸€å¤</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    
    <style>
        /* å…¨å±€å­—ä½“ */
        body {
            font-family: 'ZCOOL KuaiLe', cursive, sans-serif;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            background-color: #AEE2FF; /* æ›´æ˜äº®çš„å¤©ç©ºè“ */
        }

        /* é”å®šæ»šåŠ¨ */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        /* === å¡é€šé£æ ¼æ ¸å¿ƒ CSS === 
           ä½¿ç”¨ç¡¬é˜´å½± (0px blur) åˆ¶é€ ç©å…·ç§¯æœ¨çš„æ„Ÿè§‰
        */
        .cartoon-card {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            top: 0;
            left: 0;
        }
        
        /* ç§»åŠ¨ç«¯æŒ‰ä¸‹æ•ˆæœï¼šå¡ç‰‡ä¸‹æ²‰ï¼Œé˜´å½±æ¶ˆå¤± */
        .cartoon-card:active {
            transform: translate(4px, 4px) !important; /* å‘å³ä¸‹ç§»åŠ¨ï¼ŒæŠµæ¶ˆé˜´å½± */
            box-shadow: 0px 0px 0px 0px !important; /* é˜´å½±æ¶ˆå¤± */
        }

        /* æ ‡é¢˜æ–‡å­—æè¾¹æ•ˆæœï¼Œåƒæ¼«ç”» Logo */
        .cartoon-text-stroke {
            -webkit-text-stroke: 2px #0ea5e9; /* è“è‰²æè¾¹ */
            text-shadow: 4px 4px 0px rgba(0,0,0,0.1);
        }
        .cartoon-text-stroke-white {
            -webkit-text-stroke: 3px #ffffff;
            paint-order: stroke fill;
        }

        /* èƒŒæ™¯äº‘æœµåŠ¨ç”» */
        @keyframes floatCloud {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100vw); }
        }
        .cloud { position: absolute; opacity: 0.9; pointer-events: none; z-index: 0; filter: drop-shadow(0 4px 0 rgba(0,0,0,0.1)); }
        .cloud-1 { top: 5%; left: -20%; animation: floatCloud 25s linear infinite; font-size: 5rem; }
        .cloud-2 { top: 18%; left: -10%; animation: floatCloud 35s linear infinite; animation-delay: 5s; font-size: 3.5rem; }
        .cloud-3 { top: 10%; left: -30%; animation: floatCloud 40s linear infinite; animation-delay: 8s; font-size: 6rem; }

        /* æ‚¬åœæŠ–åŠ¨ (ä»…é™éè§¦æ‘¸è®¾å¤‡) */
        @media (hover: hover) {
            .cartoon-card:hover {
                transform: translateY(-4px);
            }
            .cartoon-card:hover .icon-shake {
                animation: shake 0.5s ease-in-out infinite;
            }
        }

        @keyframes shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        /* è£…é¥°å…ƒç´ åŠ¨ç”» */
        .spin-slow { animation: spin 8s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        
        .float-y { animation: floatY 3s ease-in-out infinite; }
        @keyframes floatY { 
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* éŸ³ä¹æŒ‰é’®åŠ¨ç”» */
        .music-playing { animation: pulse-music 1.5s infinite; }
        @keyframes pulse-music {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
    
    <!-- é…ç½® Tailwind è‡ªå®šä¹‰é¢œè‰² -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    boxShadow: {
                        'cartoon-yellow': '6px 6px 0px 0px #d97706', // æ©™è‰²ç¡¬é˜´å½±
                        'cartoon-indigo': '6px 6px 0px 0px #312e81', // æ·±è“ç¡¬é˜´å½±
                        'cartoon-green': '6px 6px 0px 0px #14532d', // æ·±ç»¿ç¡¬é˜´å½±
                        'cartoon-orange': '6px 6px 0px 0px #7c2d12', // æ·±æ£•ç¡¬é˜´å½±
                        'cartoon-pink': '6px 6px 0px 0px #be185d',   // æ·±ç²‰ç¡¬é˜´å½±
                        'cartoon-white': '6px 6px 0px 0px #94a3b8',   // ç°è‰²ç¡¬é˜´å½±
                        'cartoon-black': '4px 4px 0px 0px rgba(0,0,0,1)', // é»‘è‰²ç¡¬é˜´å½±
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-[#AEE2FF] min-h-screen relative pb-safe select-none">

    <!-- éŸ³ä¹æ’­æ”¾å¼€å…³ï¼šå·¦ä¸Šè§’ -->
    <button id="music-btn" onclick="toggleMusic(event)" class="fixed top-4 left-4 z-50 bg-white border-4 border-black rounded-full w-14 h-14 md:w-16 md:h-16 flex items-center justify-center shadow-cartoon-black transition-transform active:translate-x-1 active:translate-y-1 active:shadow-none music-playing">
        <span id="music-icon" class="text-2xl md:text-3xl">ğŸµ</span>
    </button>

    <!-- è£…é¥°äº‘æœµ -->
    <div class="cloud cloud-1">â˜ï¸</div>
    <div class="cloud cloud-2">â˜ï¸</div>
    <div class="cloud cloud-3">â˜ï¸</div>
    
    <!-- å¤ªé˜³è£…é¥° -->
    <div class="fixed top-[-50px] right-[-50px] w-40 h-40 md:w-60 md:h-60 bg-yellow-300 rounded-full border-4 border-yellow-500 z-0 spin-slow flex items-center justify-center opacity-80">
        <div class="text-4xl md:text-6xl animate-pulse">â˜€ï¸</div>
    </div>

    <main class="relative z-10 container mx-auto px-4 py-6 md:py-10 max-w-5xl">
        
        <!-- æ ‡é¢˜åŒºï¼šæ›´å¤¸å¼ çš„æ¼«ç”»é£æ ¼ -->
        <header class="text-center mb-10 md:mb-14 relative">
            <h1 class="text-6xl md:text-9xl text-yellow-400 cartoon-text-stroke font-black transform -rotate-2 inline-block relative z-10 drop-shadow-lg">
                å˜Ÿå˜Ÿä¹å›­
                <!-- è£…é¥°æ€§çš„å°æ˜Ÿæ˜Ÿ -->
                <span class="absolute -top-4 -left-6 text-4xl text-white animate-bounce">âœ¨</span>
                <span class="absolute bottom-2 -right-8 text-4xl text-white animate-bounce" style="animation-delay: 0.5s">âœ¨</span>
            </h1>
            
            <div class="mt-6 flex justify-center">
                <div class="bg-white border-4 border-blue-400 rounded-full px-6 py-3 shadow-cartoon-white transform rotate-1">
                    <p class="text-xl md:text-3xl text-blue-500 font-bold">
                        ğŸ¦ å¿«ä¹å¤å¤© â€¢ åªæœ‰å¼€å¿ƒ ğŸ‰
                    </p>
                </div>
            </div>
        </header>

        <!-- å¡ç‰‡ç½‘æ ¼ï¼šé—´è·é€‚ä¸­ï¼Œé€‚é… iPad -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-10 pb-24">
            
            <!-- 1. è¯´è‹±è¯­ (é²œè‰³é»„ + æ©™è‰²æè¾¹) -->
            <div onclick="openModal('è‹±è¯­å¤§å†’é™©', 'Hello! è·Ÿé¹¦é¹‰çš®çš®å­¦è¯´è¯å§ï¼Are you ready?', 'bg-yellow-400', 'border-yellow-600')" 
                 class="cartoon-card bg-yellow-300 border-4 border-yellow-600 rounded-[2rem] p-4 h-56 md:h-64 shadow-cartoon-yellow flex flex-col items-center justify-center relative overflow-hidden group cursor-pointer">
                <!-- å†…éƒ¨ç™½è‰²åœ†åœˆèƒŒæ™¯ -->
                <div class="absolute w-32 h-32 bg-white/40 rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 scale-150"></div>
                
                <div class="icon-shake text-6xl md:text-7xl z-10 mb-2 drop-shadow-md">ğŸ¦œ</div>
                <h2 class="text-3xl md:text-4xl text-yellow-900 font-black z-10">è¯´è‹±è¯­</h2>
                <div class="bg-white/80 px-3 py-1 rounded-full mt-2 z-10 border-2 border-yellow-600">
                    <span class="text-yellow-800 font-bold">ABC Time</span>
                </div>
                
                <!-- è£…é¥°è´´çº¸ -->
                <div class="absolute top-3 left-3 text-4xl opacity-60 rotate-[-15deg]">ğŸ…°ï¸</div>
                <div class="absolute bottom-3 right-3 text-4xl opacity-60 rotate-[15deg]">ğŸ…±ï¸</div>
            </div>

            <!-- 2. ç©¿è¶Šå¤ªç©º (é“¶æ²³ç´« + æ·±è“æè¾¹) -->
            <div onclick="openModal('å¤ªç©ºæ¢é™©', 'ç©¿ä¸Šå®‡èˆªæœï¼Œæˆ‘ä»¬è¦é£å‘ç«æ˜Ÿå•¦ï¼3...2...1...å‘å°„ï¼', 'bg-indigo-500', 'border-indigo-800')"
                 class="cartoon-card bg-indigo-400 border-4 border-indigo-800 rounded-[2rem] p-4 h-56 md:h-64 shadow-cartoon-indigo flex flex-col items-center justify-center relative overflow-hidden group cursor-pointer">
                <!-- å†…éƒ¨æ˜Ÿç©ºè£…é¥° -->
                <div class="absolute top-4 left-8 text-white text-opacity-40 text-xl">âœ¦</div>
                <div class="absolute bottom-8 right-6 text-white text-opacity-40 text-2xl">âœ¦</div>
                
                <div class="space-icon text-6xl md:text-7xl z-10 mb-2 drop-shadow-md float-y">ğŸš€</div>
                <h2 class="text-3xl md:text-4xl text-white font-black z-10 cartoon-text-stroke-white" style="-webkit-text-stroke: 0px;">ç©¿è¶Šå¤ªç©º</h2>
                 <div class="bg-indigo-900/30 px-3 py-1 rounded-full mt-2 z-10 border-2 border-indigo-200">
                    <span class="text-indigo-100 font-bold">Space Go!</span>
                </div>
                
                <div class="absolute -bottom-4 -left-4 text-6xl opacity-30">ğŸª</div>
            </div>

            <!-- 3. è¿è¿çœ‹ (é²œè‰ç»¿ + æ·±ç»¿æè¾¹) -->
            <div onclick="openModal('è¶£å‘³è¿è¿çœ‹', 'è¿™é‡Œæœ‰å¥½å¤šæ°´æœå’ŒåŠ¨ç‰©ï¼Œå¿«æ¥å¸®å®ƒä»¬æ‰¾æœ‹å‹ï¼', 'bg-green-500', 'border-green-800')"
                 class="cartoon-card bg-green-400 border-4 border-green-800 rounded-[2rem] p-4 h-56 md:h-64 shadow-cartoon-green flex flex-col items-center justify-center relative overflow-hidden group cursor-pointer">
                <!-- æ£‹ç›˜æ ¼è£…é¥°èƒŒæ™¯ -->
                <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#064e3b 2px, transparent 2px); background-size: 20px 20px;"></div>
                
                <div class="icon-shake text-6xl md:text-7xl z-10 mb-2 drop-shadow-md">ğŸ§©</div>
                <h2 class="text-3xl md:text-4xl text-green-900 font-black z-10">è¿è¿çœ‹</h2>
                 <div class="bg-white/80 px-3 py-1 rounded-full mt-2 z-10 border-2 border-green-800">
                    <span class="text-green-800 font-bold">Puzzle Fun</span>
                </div>
                
                <div class="absolute top-3 right-3 w-8 h-8 rounded-lg bg-red-400 border-2 border-black transform rotate-12"></div>
                <div class="absolute top-8 right-8 w-8 h-8 rounded-lg bg-blue-400 border-2 border-black transform -rotate-12"></div>
            </div>

            <!-- 4. å’–å•¡æœºåŸç† (ç„¦ç³–æ©™ + æ·±æ£•æè¾¹) - æ”¹é€ å¾—æ›´åƒç©å…· -->
            <div onclick="openModal('ç¥å¥‡æœºå™¨', 'é½¿è½®è½¬å•Šè½¬ï¼Œæ°´å˜çƒ­å•¦ï¼æ¥çœ‹çœ‹æœºå™¨è‚šå­é‡Œæœ‰ä»€ä¹ˆï¼Ÿ', 'bg-orange-500', 'border-orange-800')"
                 class="cartoon-card bg-orange-300 border-4 border-orange-800 rounded-[2rem] p-4 h-56 md:h-64 shadow-cartoon-orange flex flex-col items-center justify-center relative overflow-hidden group cursor-pointer">
                
                <div class="absolute top-0 right-0 w-24 h-24 bg-orange-400 rounded-bl-full z-0"></div>
                <div class="absolute top-4 right-4 text-3xl spin-slow opacity-50">âš™ï¸</div>
                
                <div class="relative z-10 mb-2">
                    <div class="text-6xl md:text-7xl drop-shadow-md">ğŸ¤–</div>
                    <!-- å°æ°”æ³¡ -->
                    <div class="absolute -top-2 -right-2 text-2xl animate-bounce">â˜•</div>
                </div>
                
                <h2 class="text-3xl md:text-4xl text-orange-900 font-black z-10">æœºå™¨åŸç†</h2>
                 <div class="bg-white/80 px-3 py-1 rounded-full mt-2 z-10 border-2 border-orange-800">
                    <span class="text-orange-800 font-bold">Science</span>
                </div>
            </div>

            <!-- 5. çˆ±æ„ (æ³¡æ³¡ç³–ç²‰ + æ·±ç²‰æè¾¹) -->
            <div onclick="openModal('çˆ±çš„ä¿¡ç®±', 'è¿™é‡Œè—ç€çˆ¸çˆ¸å¦ˆå¦ˆçš„æ‚„æ‚„è¯ï¼Œè¿˜æœ‰å¥½å¤šçˆ±å¿ƒå“¦ï¼', 'bg-pink-400', 'border-pink-700')"
                 class="cartoon-card bg-pink-300 border-4 border-pink-700 rounded-[2rem] p-4 h-56 md:h-64 md:col-span-2 lg:col-span-1 shadow-cartoon-pink flex flex-col items-center justify-center relative overflow-hidden group cursor-pointer">
                <!-- çˆ±å¿ƒæ³¢çº¹èƒŒæ™¯ -->
                <div class="absolute w-[200%] h-[200%] bg-pink-200 rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-50 pointer-events-none"></div>
                
                <div class="icon-shake text-6xl md:text-7xl z-10 mb-2 drop-shadow-md text-red-500">ğŸ’Œ</div>
                <h2 class="text-3xl md:text-4xl text-pink-900 font-black z-10">çˆ±æ„æ»¡æ»¡</h2>
                 <div class="bg-white/80 px-3 py-1 rounded-full mt-2 z-10 border-2 border-pink-700">
                    <span class="text-pink-700 font-bold">For You â¤ï¸</span>
                </div>
                
                <div class="absolute bottom-4 left-4 text-4xl animate-pulse">ğŸ§¸</div>
                <div class="absolute top-4 right-4 text-4xl rotate-12">ğŸˆ</div>
            </div>

        </div>

        <footer class="text-center pb-safe mt-4">
            <div class="inline-block bg-white/80 backdrop-blur px-6 py-2 rounded-full border-2 border-blue-200 text-blue-500 font-bold shadow-sm">
                Made for Dudu with â¤ï¸
            </div>
        </footer>
    </main>

    <!-- å¼¹çª— (å¡é€šé£æ ¼åŒ–) -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black/70 z-50 hidden flex items-center justify-center backdrop-blur-sm p-4 transition-opacity duration-300">
        <!-- å¼¹çª—æœ¬ä½“ï¼šåŠ ç²—è¾¹æ¡†å’Œç¡¬é˜´å½± -->
        <div id="modal-content" class="bg-white rounded-[2.5rem] border-[6px] border-black w-full max-w-lg p-6 md:p-10 relative shadow-[8px_8px_0px_0px_rgba(0,0,0,0.2)] transform scale-90 opacity-0 transition-all duration-300 text-center max-h-[85vh] overflow-y-auto">
            
            <!-- å…³é—­æŒ‰é’® -->
            <button onclick="closeModal()" class="absolute top-4 right-4 bg-red-400 hover:bg-red-500 border-2 border-black rounded-full w-10 h-10 md:w-12 md:h-12 flex items-center justify-center text-white transition-transform active:scale-90 z-20">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <!-- å›¾æ ‡åœ†åœˆ -->
            <div id="modal-icon-bg" class="w-24 h-24 md:w-32 md:h-32 rounded-full mx-auto mb-6 flex items-center justify-center border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.1)] bg-yellow-300">
                <span id="modal-icon" class="text-5xl md:text-7xl filter drop-shadow-sm">ğŸ‰</span>
            </div>
            
            <h3 id="modal-title" class="text-3xl md:text-5xl text-gray-900 mb-4 font-black tracking-wide">æ ‡é¢˜</h3>
            
            <p id="modal-desc" class="text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed font-medium px-2">
                æè¿°å†…å®¹
            </p>
            
            <!-- æŒ‰é’® -->
            <button onclick="enterPage()" id="modal-btn" class="w-full text-2xl md:text-3xl py-4 rounded-2xl font-black border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all active:translate-x-[4px] active:translate-y-[4px] active:shadow-none bg-green-400 text-white flex items-center justify-center gap-2 relative overflow-hidden">
                <span class="relative z-10">Go! å‡ºå‘! ğŸš€</span>
            </button>
        </div>
    </div>

    <script>
        const body = document.body;
        const backdrop = document.getElementById('modal-backdrop');
        const content = document.getElementById('modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalDesc = document.getElementById('modal-desc');
        const modalIcon = document.getElementById('modal-icon');
        const modalIconBg = document.getElementById('modal-icon-bg');
        const modalBtn = document.getElementById('modal-btn');
        const musicBtn = document.getElementById('music-btn');
        const musicIcon = document.getElementById('music-icon');

        // --- ç®€æ˜“éŸ³ä¹åˆæˆå™¨ (Web Audio API) ---
        let audioCtx = null;
        let isPlaying = false; // UIæ˜¾ç¤ºçŠ¶æ€
        let isInitialized = false; // çœŸå®éŸ³é¢‘ç¯å¢ƒçŠ¶æ€
        let nextNoteTime = 0;
        let timerID = null;
        let noteIndex = 0;

        // Twinkle Twinkle Little Star ç®€è°± (1=C)
        const notes = [
            {f: 261.63, d: 0.5}, {f: 261.63, d: 0.5}, {f: 392.00, d: 0.5}, {f: 392.00, d: 0.5}, 
            {f: 440.00, d: 0.5}, {f: 440.00, d: 0.5}, {f: 392.00, d: 1.0},
            {f: 349.23, d: 0.5}, {f: 349.23, d: 0.5}, {f: 329.63, d: 0.5}, {f: 329.63, d: 0.5}, 
            {f: 293.66, d: 0.5}, {f: 293.66, d: 0.5}, {f: 261.63, d: 1.0},
            {f: 392.00, d: 0.5}, {f: 392.00, d: 0.5}, {f: 349.23, d: 0.5}, {f: 349.23, d: 0.5}, 
            {f: 329.63, d: 0.5}, {f: 329.63, d: 0.5}, {f: 293.66, d: 1.0},
            {f: 392.00, d: 0.5}, {f: 392.00, d: 0.5}, {f: 349.23, d: 0.5}, {f: 349.23, d: 0.5}, 
            {f: 329.63, d: 0.5}, {f: 329.63, d: 0.5}, {f: 293.66, d: 1.0},
            {f: 261.63, d: 0.5}, {f: 261.63, d: 0.5}, {f: 392.00, d: 0.5}, {f: 392.00, d: 0.5}, 
            {f: 440.00, d: 0.5}, {f: 440.00, d: 0.5}, {f: 392.00, d: 1.0},
            {f: 349.23, d: 0.5}, {f: 349.23, d: 0.5}, {f: 329.63, d: 0.5}, {f: 329.63, d: 0.5}, 
            {f: 293.66, d: 0.5}, {f: 293.66, d: 0.5}, {f: 261.63, d: 1.0},
        ];

        // åˆå§‹åŒ–éŸ³é¢‘ç¯å¢ƒ - å¿…é¡»åœ¨ç”¨æˆ·ç‚¹å‡»äº‹ä»¶ä¸­è°ƒç”¨
        function tryInitAudio() {
            if (isInitialized) return;

            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (!AudioContext) return;

                audioCtx = new AudioContext();
                
                // åœ¨ iOS ä¸Šï¼Œä»…ä»… new æ˜¯ä¸å¤Ÿçš„ï¼Œå¿…é¡» resume
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }

                isInitialized = true;
                
                // é»˜è®¤ UI æ˜¯å¼€å¯çŠ¶æ€ï¼Œæ‰€ä»¥ä¸€åˆå§‹åŒ–å°±æ’­æ”¾
                isPlaying = true; 
                nextNoteTime = audioCtx.currentTime + 0.1;
                playNote();
                
                // ç§»é™¤ç›‘å¬ï¼Œé¿å…é‡å¤
                document.removeEventListener('click', tryInitAudio);
                document.removeEventListener('touchstart', tryInitAudio);
            } catch (e) {
                console.error("Audio init failed", e);
            }
        }

        // æ‰‹åŠ¨åˆ‡æ¢éŸ³ä¹æŒ‰é’®
        function toggleMusic(event) {
            event.stopPropagation();
            
            // å¦‚æœè¿˜æ²¡åˆå§‹åŒ–ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªç”¨æˆ·ç‚¹å‡»äº‹ä»¶ï¼Œå¯ä»¥åˆå§‹åŒ–
            if (!isInitialized) {
                tryInitAudio();
                return;
            }

            if (isPlaying) {
                // æš‚åœ
                if (audioCtx.state === 'running') {
                    audioCtx.suspend();
                }
                isPlaying = false;
                musicIcon.textContent = 'ğŸ”‡';
                musicIcon.classList.add('grayscale', 'opacity-50');
                musicBtn.classList.remove('music-playing');
            } else {
                // æ’­æ”¾
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }
                // é‡ç½®æ—¶é—´é˜²æ­¢èµ¶æ‹å­
                nextNoteTime = audioCtx.currentTime + 0.1;
                playNote();
                isPlaying = true;
                musicIcon.textContent = 'ğŸµ';
                musicIcon.classList.remove('grayscale', 'opacity-50');
                musicBtn.classList.add('music-playing');
            }
        }

        function playNote() {
            if (!isPlaying || !audioCtx) return;

            // å¦‚æœæ—¶é—´è½åå¤ªå¤šï¼ˆæ¯”å¦‚åˆ‡åå°ï¼‰ï¼Œé‡ç½®æ—¶é—´
            if (nextNoteTime < audioCtx.currentTime) {
                nextNoteTime = audioCtx.currentTime + 0.1;
            }

            // è°ƒåº¦éŸ³ç¬¦
            while (nextNoteTime < audioCtx.currentTime + 0.1) {
                scheduleNote(notes[noteIndex], nextNoteTime);
                nextNoteTime += notes[noteIndex].d;
                noteIndex = (noteIndex + 1) % notes.length;
            }
            
            timerID = requestAnimationFrame(playNote);
        }

        function scheduleNote(note, time) {
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.type = 'sine'; 
            osc.frequency.value = note.f;

            // ç¨å¾®æé«˜ä¸€ç‚¹éŸ³é‡ (0.1 -> 0.15)
            gainNode.gain.setValueAtTime(0, time);
            gainNode.gain.linearRampToValueAtTime(0.15, time + 0.05); 
            gainNode.gain.exponentialRampToValueAtTime(0.001, time + note.d - 0.05);

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            osc.start(time);
            osc.stop(time + note.d);
        }

        // é¡µé¢åŠ è½½æ—¶æ·»åŠ å…¨å±€ç›‘å¬å™¨ï¼Œç­‰å¾…ç”¨æˆ·ç¬¬ä¸€æ¬¡ç‚¹å‡»
        window.addEventListener('DOMContentLoaded', () => {
            // ä¸€æ¬¡æ€§ç›‘å¬å™¨ï¼šåªè¦æœ‰ç‚¹æŒ‰ï¼Œå°±å°è¯•å¯åŠ¨éŸ³é¢‘
            document.addEventListener('click', tryInitAudio, {once:true});
            document.addEventListener('touchstart', tryInitAudio, {once:true});
        });


        // --- æ¨¡æ€æ¡†é€»è¾‘ (ä¿æŒä¸å˜) ---
        function openModal(title, desc, colorClass, borderClass) {
            body.classList.add('modal-open');

            modalTitle.textContent = title;
            modalDesc.textContent = desc;
            
            const colorBase = colorClass.replace('bg-', ''); 
            
            modalIconBg.className = `w-24 h-24 md:w-32 md:h-32 rounded-full mx-auto mb-6 flex items-center justify-center border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.1)] ${colorClass}`;
            
            modalBtn.className = `w-full text-2xl md:text-3xl py-4 rounded-2xl font-black border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all active:translate-x-[4px] active:translate-y-[4px] active:shadow-none ${colorClass} text-white flex items-center justify-center gap-2 relative overflow-hidden`;

            if (title.includes('è‹±è¯­')) modalIcon.textContent = 'ğŸ¦œ';
            else if (title.includes('å¤ªç©º')) modalIcon.textContent = 'ğŸ‘¨â€ğŸš€';
            else if (title.includes('è¿è¿çœ‹')) modalIcon.textContent = 'ğŸ§©';
            else if (title.includes('æœºå™¨')) modalIcon.textContent = 'ğŸ¤–';
            else if (title.includes('çˆ±')) modalIcon.textContent = 'ğŸ’Œ';
            else modalIcon.textContent = 'ğŸ‰';

            backdrop.classList.remove('hidden');
            void backdrop.offsetWidth; 
            backdrop.classList.remove('opacity-0');
            content.classList.remove('scale-90', 'opacity-0');
            content.classList.add('scale-100', 'opacity-100');
        }

        function closeModal() {
            body.classList.remove('modal-open');
            backdrop.classList.add('opacity-0');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-90', 'opacity-0');
            setTimeout(() => { backdrop.classList.add('hidden'); }, 300);
        }

        function enterPage() {
            const btn = event.currentTarget;
            const span = btn.querySelector('span');
            const originalText = span.textContent;
            
            span.textContent = "å¯åŠ¨å¼•æ“... ğŸ’¨";
            btn.classList.add('grayscale');
            
            setTimeout(() => {
                span.textContent = originalText;
                btn.classList.remove('grayscale');
                closeModal();
            }, 1500);
        }

        backdrop.addEventListener('click', (e) => {
            if (e.target === backdrop) closeModal();
        });
    </script>
</body>
</html>